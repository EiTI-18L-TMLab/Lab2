org 1800h
START:
	LD SP, 0x1FFF
	jr MAIN
ds 0x1838-$,0 ;org 1838h
INTERRUPT:
	PUSH AF
	IN A, (1)
	AND 0Fh
	LD B, A
	OUT (1), A
	POP AF
	EI
	RET
ds 0x1860-$,0 ;org 1860h
MAIN:
	IN A, (1) ; ≈ÅADOWANIE Z WEJSCIA
	AND 0Fh
	LD B, A
	OUT (1), A ; ODSWIEzENIE LED
	LD D, 255
	IM 1
	EI	
	LD C, D
	IN A, (1)
	BIT 6, A ; PRZYCISK CLK
	LD E, 0
MAIN_LOOP:
	LD A, E
	AND 0xFF
	JR NZ, LOOP_POSITIVE

LOOP_NEGATIVE:
	IN A, (1)
	BIT 6, A ; PRZYCISK CLK	
	JR Z, IF_1
	LD C, D
IF_1:
	JR NZ, IF_2
	DEC C
IF_2:
	JR NZ, MAIN_LOOP
	DEC B
	DI
	LD A, B
	AND 0Fh
	OUT (1), A
	EI
	LD E, 1
	JR MAIN_LOOP
LOOP_POSITIVE:
	IN A, (1)
	BIT 6, A ; PRZYCISK CLK	
	JR NZ, IF_3
	LD C, D
IF_3:
	JR Z, IF_4
	DEC C
IF_4:
	JR Z, MAIN_LOOP
	LD E, 0
	JR MAIN_LOOP